# Run all Question Codes seperately in Rstudio as the names for dataframes in the .RData files may overlap. 

#### Q1 Qualities and Characteristics of Role Models ####
library(ggplot2)
library(useful)
library(dplyr)
library(viridis)
library(tidyverse)

level_order <- c('First (n=17)', 'Second (n=14)', 'Third (n=9)', "Fourth (n=5)", "All Years (n=45)") 
colours <- c("#0d0887","#cc4778","#ed7953")

##### Bubble Plot for Qualities of Role Models by the Year #####
bubbleplot= ggplot(Qualities, aes(x = Year, y = Percent, size = Percent))+                    #Plots year by percent with size of points by percent
  scale_x_discrete(limits = level_order, 
                   labels = function(level_order) stringr::str_wrap(level_order, width = 9))+ #xaxis on two lines
  scale_radius(range = c(5, 18), guide = NULL) +                                              #makes size of points scaled between the range of 5,18, removes legend
  geom_point(alpha=0.5, aes(colour = Qualities)) +                                            #Opacity of points and colors points by Factor, adds legend
    scale_color_viridis(discrete=TRUE, option="C") +                                          #colour scale options from C,D, (option="H", end = 0.7)
    guides(color = guide_legend(override.aes = list(size = 3)))+
  geom_point(data=QualitiesOverlap, alpha=0.5, aes(color= "Identity"))+                       #Adds same colour by legend for overlapped point 
  geom_text(data=Qualities, aes(y=Percent, label=Percent), color="black", size=3)+            #Adds text on top of point
  theme_minimal() +
  xlab("Year of Study")+
  ylab("Proportion of Respondents (%)")+
  theme(axis.text.x = element_text(colour = "black"))+
  theme(axis.text.y = element_text(colour = "black"))
bubbleplot 

##### Bubble Plot Characteristics of Role Models by the Year #####
bubbleplot= ggplot(Traits, aes(x = Year, y = Percent, size = Percent))+
  scale_x_discrete(limits = level_order, 
                   labels = function(level_order) stringr::str_wrap(level_order, width = 9))+  
  #scale_size(range = c(6, 12), name = "Proportion of Students")+
  scale_radius(range = c(5, 18), guide= NULL) +
  geom_point(alpha = 0.5, aes(color = Traits))+
    scale_color_viridis(discrete=TRUE, option = "C") + #begin= 0.32, end=0.95
    guides(color = guide_legend(override.aes = list(size = 3)))+
  geom_point(data=TraitsOverlap2, alpha = 0.5, aes(color= "Support"))+
  geom_text(data=Traits, aes(y=Percent, label=Percent), color = "black", size =3.5)+
  theme_minimal() +
  xlab("Year of Study")+
  ylab("Proportion of Respondents (%)")+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text.x = element_text(colour = "black"))+
  theme(axis.text.y = element_text(colour = "black"))
bubbleplot

##### Bubble Plot Characteristics of Role Models Described in Q1 & Q4#####
bubbleplot= ggplot(TraitsQ4, aes(x = Year, y = Percent, size = Percent))+
  scale_x_discrete(limits = level_order, 
                   labels = function(level_order) stringr::str_wrap(level_order, width = 9))+  
  #scale_size(range = c(6, 12), name = "Proportion of Students")+
  scale_radius(limits = c(0, NA), range = c(5, 18), guide = NULL) +
  geom_point(alpha = 0.5, aes(color = Traits))+
  scale_color_viridis(discrete=TRUE, option = "C") + #begin= 0.32, end=0.95
  guides(color = guide_legend(override.aes = list(size = 3)))+
  geom_point(data=TraitsOverlapQ4, alpha = 0.4, aes(colour = Traits))+
  geom_text(data=TraitsQ4, aes(y=Percent, label=Percent), color = "black", size =3.2)+
  theme_minimal() +
  xlab("Year of Study")+
  ylab("Proportion of Respondents (%)")+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text.x = element_text(colour = "black"))+
  theme(axis.text.y = element_text(colour = "black"))
bubbleplot + expand_limits(y = 0)

#### Q2 Graphs ####
library(ggplot2)
library(useful)
library(dplyr)
library(viridis)
library(tidyverse)
Level_order <- c("First Year (n=13)", "Second Year (n=14)", "Third Year (n=9)", "Fourth Year (n=5)")

pplot = ggplot(Q2Data, aes(x = Study_Level, y = Counts, fill = Response)) +
  geom_bar(stat = "identity", width = 0.70) +
  coord_flip() +
  scale_x_discrete(limits = Level_order) +
  scale_y_continuous(breaks = seq(-10, 10, 1),
                     labels = abs(seq(-10, 10, 1))) +
  scale_x_discrete(limits = Level_order, labels = function(Level_order)stringr::str_wrap(Level_order, width = 15))+
  scale_fill_viridis(name=NULL, discrete=TRUE, alpha=1, option="C",
                     breaks=c("Disciplinary Belonging", "Social Belonging"),
                     labels=c("Disciplinary Belonging", "Social Belonging"))+
  theme(legend.position = "bottom",
        legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5))+
  theme_minimal() +
  #ggtitle("Role Model Distribution")+
  ylab("Count of Respondents (%)")+
  xlab("Year of Study")
pplot + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
             panel.grid.minor = element_blank(), axis.line = element_line(colour = "grey"))
 
#### Q3 Graphs ####
library(ggplot2)
library(useful)
library(dplyr)
library(viridis)
library(tidyverse)
level_order <- c('First (n=12)', 'Second (n=13)', 'Third (n=9)', "Fourth (n=4)")

# Copy Old dataframe to New DataFrame.
newDF <- Graph_Q2_Q3

# Change the order of Response column of DataFrame
newDF$Response <- factor(newDF$Response,
                         levels = c("Presence of Role Model was Beneficial",
                                    "Lack of Role Model was Deleterious",
                                    "Mentioned Both"))

Q3plot<- ggplot(newDF, aes(x = Study_Level, y = Proportion, fill =  Response)) +
  scale_x_discrete(limits = level_order, labels = function(level_order) stringr::str_wrap(level_order, width = 9))+
  labs(title = NULL,
       x = "Year of Study",
       y = "Proportion of Respondents (%)",
       fill = "Response") +
  geom_bar(stat = "identity")+
  scale_fill_viridis_d(option = "plasma")+
  theme_minimal()+
  theme(axis.text.x = element_text(colour = "black"))+
  theme(axis.text.y = element_text(colour = "black"))
Q3plot #run the code above first then highlight and run the code below

Q3plot + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                  panel.grid.minor = element_blank(), axis.line = element_line(colour = "grey"))

#### Q4 Graphs ####
#### Figure 5A: Classification of personal and distant role models ####

### Figure 5B: Perception of Instructors as Personal or Distant Role models ####
library(tidyr)
library(dplyr)
library(ggplot2)

university_level <- c("First (n=7)", "Second (n=8)", "Third (n=4)", "Fourth (n=4)")
personal_role_model <- c(4, 0, 0, 4)
distant_role_model <- c(3, 8, 4, 0)

data <- data.frame(Level = university_level, Personal = personal_role_model, Distant = distant_role_model)

data_long <- data %>%
pivot_longer(cols = c(Personal, Distant), names_to = "Model", values_to = "Count")

data_long <- data_long %>%
group_by(Level) %>%
mutate(Proportion = Count / sum(Count))

ggplot(data_long, aes(x = Level, y = Proportion, fill = Model)) +
geom_bar(stat = "identity") +
scale_fill_viridis_d(option = "plasma") +
scale_y_continuous(labels = function(x) paste0(format(x * 100, nsmall = 0), "")) +
scale_x_discrete(limits = university_level, labels = function(university_level) stringr::str_wrap(university_level, width = 15)) +
labs(title = "Proportion of How Students View Instructors as Role Models by Year of Study", x = "Year of Study", y = "Proportion of Respondents (%)", fill = "Types of Role Models") +
theme_minimal() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "grey"), legend.text = element_text(size = 12), legend.title  = element_text(size = 12), axis.title.x = element_text(size = 12), axis.title.y = element_text(size = 12))

#### Q6 Graphs ####
library(ggplot2)
library(useful)
library(dplyr)
library(viridis)
library(tidyverse)

DSBG <- data.frame(RoleModels = c("Family", "Family", "School Teacher", "School Teacher", "Instructors", "Instructors", "Public Figures", "Public Figures", "Peers", "Peers"),
                    PP = c("Persistence", "Pursuit", "Persistence", "Pursuit", "Persistence", "Pursuit", "Persistence", "Pursuit", "Persistence", "Pursuit"),
                    Percentage = c(25,-49,0,-43,42,0,8,-9,25,0))

category_order <- c("Family", "Instructors","School Teacher", "Peers", "Public Figures") 

pplot = ggplot(DSBG, aes(x = RoleModels, y = Percentage, fill = PP)) +
  geom_bar(stat = "identity", width = 0.75) +
  coord_flip() +
  scale_x_discrete(limits = category_order) +
  # another trick!
  scale_y_continuous(breaks = seq(-100, 100, 20), 
                     labels = abs(seq(-100, 100, 20))) +
  scale_x_discrete(limits = category_order, labels = function(category_order)stringr::str_wrap(category_order, width = 15))+
  scale_fill_viridis(name=NULL, discrete=TRUE, alpha=1, option="C", 
                     breaks=c("Pursuit", "Persistence"),
                     labels=c("Pursuit", "Persistence"))+
  theme(legend.position = "bottom",
        legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5))+
  theme_minimal() +
  #ggtitle("Role Model Distribution")+
  ylab("Proportion of Respondents (%)")+
  xlab("Categories")
pplot
pplot + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
              panel.grid.minor = element_blank(), axis.line = element_line(colour = "grey"))



